/* ===============================
   Design System — Components
   Требует tokens.css (переменные)
   =============================== */

/* ---------- Buttons ---------- */
.btn {
  display: inline-flex; align-items: center; justify-content: center;
  gap: var(--space-2);
  padding: 10px 16px;
  border-radius: var(--radius-pill);
  border: 1.5px solid var(--border);
  background: var(--surface-2);
  color: var(--text);
  font: 600 var(--fs-sm)/1 var(--font-sans);
  cursor: pointer;
  box-shadow: var(--shadow-sm);
  transition:
    background var(--dur-2) var(--ease),
    transform var(--dur-1) var(--ease),
    border-color var(--dur-2) var(--ease),
    box-shadow var(--dur-2) var(--ease);
}
.btn:hover { background: var(--hover); transform: translateY(-1px); }
.btn:active { transform: translateY(0); }
.btn:focus-visible {
  outline: 3px solid color-mix(in srgb, var(--brand) 40%, transparent);
  outline-offset: 2px;
}

.btn--primary {
  border-color: color-mix(in srgb, var(--brand) 25%, var(--border));
  background: linear-gradient(135deg, var(--brand), var(--brand-2));
  color: #fff;
}
.btn--primary:hover { filter: brightness(1.03); }

.btn--ghost { background: transparent; border-color: var(--border); }

.btn.active {
  border-color: var(--brand);
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--brand) 25%, transparent);
}

/* Размер/форма */
.btn--icon   { width: 44px; height: 44px; padding: 0; border-radius: var(--radius-2); font-size: 20px; }
.btn--circle { width: 44px; height: 44px; padding: 0; border-radius: 50%; }

/* Пилюли-фильтры (страница Статистика) */
.filter-btn {
  display:inline-flex; align-items:center; justify-content:center;
  padding: 8px 12px;
  border-radius: var(--radius-pill);
  border: 1.5px solid var(--border);
  background: var(--surface);
  color: var(--text);
  font: 600 var(--fs-sm)/1 var(--font-sans);
  transition:
    background var(--dur-2) var(--ease),
    border-color var(--dur-2) var(--ease),
    color var(--dur-2) var(--ease);
}
.filter-btn:hover { background: var(--hover); }
.filter-btn.active {
  background: linear-gradient(135deg, var(--brand), var(--brand-2));
  border-color: transparent;
  color: #fff;
}

/* Кнопка в установочном баннере */
.install-btn {
  display:inline-flex; align-items:center; justify-content:center; gap: var(--space-2);
  padding: 10px 16px;
  border-radius: var(--radius-pill);
  border: 1.5px solid color-mix(in srgb, var(--brand) 25%, var(--border));
  background: linear-gradient(135deg, var(--brand), var(--brand-2));
  color:#fff;
  font: 600 var(--fs-sm)/1 var(--font-sans);
  box-shadow: var(--shadow-sm);
  cursor:pointer;
}

/* ---------- Cards ---------- */
.card {
  background: var(--surface-2);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: var(--radius-2);
  padding: var(--space-4);
  box-shadow: var(--shadow-sm);
}

/* ---------- Inputs / Textarea / Chat input ---------- */
.input, .textarea, .chat-input {
  width: 100%;
  background: var(--surface);
  border: 2px solid var(--border);
  border-radius: var(--radius-2);
  color: var(--text);
  font: var(--fs-md)/1.35 var(--font-sans);
  padding: var(--space-3) var(--space-4);
  transition: border-color var(--dur-2) var(--ease), box-shadow var(--dur-2) var(--ease);
}
.input:focus, .textarea:focus, .chat-input:focus {
  border-color: var(--brand);
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--brand) 22%, transparent);
  outline: none;
}
.input::placeholder, .textarea::placeholder, .chat-input::placeholder {
  color: var(--text-muted);
}

/* чат-инпут — авто/макс высота + скрываем полосы прокрутки */
.chat-input { min-height: 44px; max-height: 160px; overflow-y: auto; resize: none; padding-right: 52px; }
.chat-input::-webkit-scrollbar { display: none; }
.chat-input { scrollbar-width: none; -ms-overflow-style: none; }

/* ---------- Chat bubbles ---------- */
.message {
  max-width: 80%;
  padding: 12px 16px;
  border-radius: 18px;
  font-size: 15px;
  line-height: 1.4;
  animation: messageSlideIn var(--dur-3) var(--ease);
}
.message.user {
  align-self: flex-end;
  background: var(--success);
  color: #fff;
  border-bottom-right-radius: 6px;
}
.message.ai {
  align-self: flex-start;
  background: var(--surface);
  color: var(--text);
  border: 1px solid var(--border);
  border-bottom-left-radius: 6px;
}
.message.system {
  align-self: center;
  background: color-mix(in srgb, var(--info) 15%, transparent);
  color: var(--text-muted);
  border-radius: var(--radius-2);
  font-size: 13px;
  text-align: center;
  max-width: 90%;
}
@keyframes messageSlideIn {
  from { opacity: 0; transform: translateY(10px); }
  to   { opacity: 1; transform: translateY(0); }
}

/* индикатор набора */
.typing-indicator {
  align-self: flex-start;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius-2);
  padding: 12px 16px;
  color: var(--text-muted);
  font-style: italic;
  animation: pulse 2s infinite;
}
@keyframes pulse { 0%,100% {opacity:1} 50% {opacity:.6} }

/* ---------- Chips ---------- */
.chip {
  display: inline-flex; align-items:center; justify-content:center;
  padding: 6px 10px;
  border-radius: var(--radius-1);
  border: 1px solid var(--border);
  background: var(--surface);
  color: var(--text);
  font: 600 var(--fs-sm)/1 var(--font-sans);
}

/* ---------- Colors for charts/bars ---------- */
.bar--good    { background: var(--success); }
.bar--neutral { background: var(--warning); }
.bar--sad     { background: var(--info); }

/* ---------- Hourly grid blocks ---------- */
.hour-block {
  text-align: center;
  padding: 8px 4px;
  border-radius: var(--radius-1);
  font-size: 11px;
  color: var(--text);
  border: 1px solid var(--border);
}
.hour-block.has-data { color: #fff; font-weight: bold; }

/* === Buttons / nav === */
.send-button {
  background: var(--mood-good);
  border: none;
  border-radius: 50%;
  width: 44px;
  height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  color: white;
  font-size: 18px;
}
.send-button:hover:not(:disabled) { background: #16a34a; transform: scale(1.05); }
.send-button:disabled { background: var(--text-secondary); cursor: not-allowed; opacity: .5; }

.nav-btn {
  background: var(--bg-primary);
  border: 2px solid var(--border-color);
  color: var(--text-primary);
  width: 44px;
  height: 44px;
  border-radius: 12px;
  font-size: 20px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all .2s ease;
}
.nav-btn:hover, .nav-btn:active {
  background: var(--day-hover);
  border-color: var(--border-hover);
  transform: scale(1.1);
}

/* === Chat input === */
/* на всякий случай прячем скроллбар в движках */
.chat-input::-webkit-scrollbar { display: none; }
.chat-input { scrollbar-width: none; -ms-overflow-style: none; }

.chat-input::placeholder {
  font-size: 14px;
  line-height: 1.3;
  color: var(--text-secondary);
}

.chat-input:focus {
  border-color: var(--mood-good);
  box-shadow: 0 0 0 3px rgba(34,197,94,.1);
}

/* === Chat bubbles === */
.message {
  max-width: 80%;
  padding: 12px 16px;
  border-radius: 18px;
  font-size: 15px;
  line-height: 1.4;
  animation: messageSlideIn .3s ease;
}
.message.user {
  align-self: flex-end;
  background: var(--mood-good);
  color: #fff;
  border-bottom-right-radius: 6px;
}
.message.ai {
  align-self: flex-start;
  background: var(--bg-primary);
  color: var(--text-primary);
  border: 1px solid var(--border-color);
  border-bottom-left-radius: 6px;
}
.message.system {
  align-self: center;
  background: rgba(59,130,246,.1);
  color: var(--text-secondary);
  border-radius: 12px;
  font-size: 13px;
  text-align: center;
  max-width: 90%;
}

/* typing indicator */
.typing-indicator {
  align-self: flex-start;
  background: var(--bg-primary);
  border: 1px solid var(--border-color);
  border-radius: 18px;
  border-bottom-left-radius: 6px;
  padding: 12px 16px;
  color: var(--text-secondary);
  font-style: italic;
  animation: pulse 2s infinite;
}

/* keyframes */
@keyframes pulse { 0%,100%{opacity:1} 50%{opacity:.6} }
@keyframes messageSlideIn { from{opacity:0; transform:translateY(10px)} to{opacity:1; transform:translateY(0)} }

/* === Stats (часовые блоки) === */
.hour-block.has-data { color:#fff; font-weight:bold; }

/* === Chat: доп. стили и анимации === */

/* прячем вертикальный скроллбар у textarea в разных движках */
.chat-input::-webkit-scrollbar { display: none; }
.chat-input { scrollbar-width: none; -ms-overflow-style: none; }

/* фокус textarea — мягкая подсветка успеха */
.chat-input:focus {
  border-color: var(--mood-good);
  box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.10);
  outline: none;
}

/* пузырьки сообщений */
.message {
  max-width: 80%;
  padding: 12px 16px;
  border-radius: 18px;
  font-size: 15px;
  line-height: 1.4;
  animation: messageSlideIn 0.3s ease;
}
.message.user {
  align-self: flex-end;
  background: var(--mood-good);
  color: #fff;
  border-bottom-right-radius: 6px;
}
.message.ai {
  align-self: flex-start;
  background: var(--bg-primary);
  color: var(--text-primary);
  border: 1px solid var(--border-color);
  border-bottom-left-radius: 6px;
}
.message.system {
  align-self: center;
  background: rgba(59,130,246,0.10); /* мягкая подсказка */
  color: var(--text-secondary);
  border-radius: 12px;
  font-size: 13px;
  text-align: center;
  max-width: 90%;
}

/* индикатор набора */
.typing-indicator {
  align-self: flex-start;
  background: var(--bg-primary);
  border: 1px solid var(--border-color);
  border-radius: 18px;
  border-bottom-left-radius: 6px;
  padding: 12px 16px;
  color: var(--text-secondary);
  font-style: italic;
  animation: pulse 2s infinite;
}

/* анимации */
@keyframes pulse { 0%,100%{opacity:1} 50%{opacity:.6} }
@keyframes messageSlideIn {
  from { opacity: 0; transform: translateY(10px); }
  to   { opacity: 1; transform: translateY(0); }
}

/* статистика по часам: если есть данные — белый текст и жирность */
.hour-block.has-data { color: #fff; font-weight: 700; }

/* === Chat: layout === */
.chat-input-container {
  padding: 12px 16px;
  background: var(--bg-secondary);
  border-top: 1px solid var(--border-color);
  display: flex;
  gap: 12px;
  align-items: flex-end;
  flex-shrink: 0;
}

.chat-input {
  flex: 1;
  background: var(--bg-primary);
  border: 2px solid var(--border-color);
  border-radius: 20px;
  padding: 12px 16px;
  padding-right: 52px;
  font-size: 15px;
  line-height: 1.35;
  color: var(--text-primary);
  resize: none;
  min-height: 44px;
  max-height: 160px;
  overflow-y: auto;
  outline: none;
  transition: all 0.2s ease;
}

/* прячем скроллбар у textarea */
.chat-input::-webkit-scrollbar { display: none; }
.chat-input { scrollbar-width: none; -ms-overflow-style: none; }

/* фокус textarea — мягкая подсветка успеха */
.chat-input:focus {
  border-color: var(--mood-good);
  box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.10);
  outline: none;
}
